# ğŸš€ StartupKit - One-Command Setup

**Clone from GitHub and get your SaaS running in 2 minutes!**

---

## âš¡ Quick Start - One Command Setup

After cloning from GitHub, run this **single command** to set up everything:

```bash
npm run setup
```

This will automatically:
- âœ… Install all dependencies
- âœ… Initialize Convex database
- âœ… Create all 30 database tables
- âœ… Seed default data (company settings, email variables, templates, invoice config)
- âœ… Create `.env.local` template
- âœ… Guide you through configuration

---

## ğŸ“‹ Complete Setup Steps

### Step 1: Clone from GitHub

```bash
git clone https://github.com/your-username/startupkit.git
cd startupkit
```

### Step 2: Run Automated Setup

```bash
npm run setup
```

**What happens:**
1. Installs npm packages
2. Asks if you want to initialize Convex (answer: **y**)
3. Initializes Convex database
4. Creates all database tables automatically
5. Seeds default data:
   - Company settings (org_settings)
   - Email template variables (platform_config)
   - Default email templates (email_templates)
6. Creates `.env.local` file with template

### Step 3: Configure Environment Variables

Open `.env.local` and add your API keys:

```env
# Convex (auto-generated by setup)
CONVEX_DEPLOYMENT=dev:xxx
NEXT_PUBLIC_CONVEX_URL=https://xxx.convex.cloud

# Clerk Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxx
CLERK_SECRET_KEY=sk_test_xxx

# Stripe Payments  
STRIPE_SECRET_KEY=sk_test_xxx
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxx
```

### Step 4: Set Super Admin Role

1. Go to [Clerk Dashboard](https://dashboard.clerk.com)
2. Navigate to **Users** â†’ Select your user
3. Click **Metadata** â†’ **Public metadata** â†’ **Edit**
4. Add:
   ```json
   {
     "role": "super_admin"
   }
   ```
5. Click **Save**

### Step 5: Start Development

```bash
npm run dev
```

Visit `http://localhost:3000` - **You're ready!** ğŸ‰

---

## ğŸ—„ï¸ Database Tables Created Automatically

The setup creates **30 tables** in Convex:

### Core User & Organization Tables
- `users` - User profiles synced from Clerk
- `admin_users` - Admin user management
- `org_settings` - Company/tenant configuration
- `org_subscriptions` - Stripe subscription management
- `subscription_transactions` - Subscription audit log

### Credit & Payment Tables
- `credits_ledger` - Credit purchase history
- `credits_balance` - Current credit balances
- `transactions` - Payment transaction history
- `invoices` - Invoice records
- `invoice_config` - Invoice configuration settings

### Email System Tables (8 tables)
- `platform_config` - Email variables and system config
- `email_templates` - Email template library
- `email_campaigns` - Campaign management
- `campaign_recipients` - Campaign recipient tracking
- `email_events` - Email analytics
- `email_logs` - Email delivery logs
- `email_unsubscribes` - Unsubscribe management

### Support & Ticketing Tables
- `support_tickets` - Support ticket system
- `ticket_messages` - Ticket conversation messages

### Notification & Alert Tables
- `admin_notifications` - Admin notification system
- `notifications_read` - Read status tracking
- `alerts` - System alerts
- `alert_dismissals` - Alert dismissal tracking

### Activity & Audit Tables
- `admin_activity_logs` - Admin action audit trail
- `user_activity_logs` - User activity tracking

### Referral System Tables
- `referrals` - Referral tracking
- `referral_codes` - Referral code management

### Security Tables
- `country_blacklist` - Country-based access control
- `ip_blacklist` - IP-based access control

### Health Monitoring Table
- `customer_health_scores` - Customer health metrics

---

## ğŸ“¦ Default Data Seeded

### Company Settings (org_settings)
```javascript
{
  companyName: "Your Company",
  companyEmail: "contact@yourcompany.com",
  companyPhone: "+1-555-0123",
  companyAddress: "123 Business St, Suite 100, City, State 12345",
  companyCountry: "United States",
  emailEnabled: true,
  sendWelcomeEmail: true,
  sendPasswordResetEmail: true,
  sendSubscriptionEmails: true,
  sendPaymentNotifications: true,
  sendUsageAlerts: true,
  sendAdminNotifications: true,
  initialSignupCredits: 10
}
```

### Email Variables (platform_config)
50+ variables including:
- `{login_link}` - Login page URL
- `{upgrade_plan}` - Pricing page URL
- `{password_reset_link}` - Password reset URL
- `{subscription_plan}` - Subscription management URL
- `{get_started_link}` - Getting started guide
- `{company_name}`, `{user_name}`, `{current_year}`
- And many more...

### Email Templates (email_templates)
- **Welcome Email** - With company_name, user_name, get_started_link variables
- **Password Reset** - With user_name, password_reset_link, company_name variables

### Invoice Configuration (invoice_config)
```javascript
{
  invoicePrefix: "INV",
  nextInvoiceNumber: 1001,
  taxRate: 0,
  currency: "USD",
  paymentTerms: "Due upon receipt",
  notes: "Thank you for your business!",
  footerText: "For questions about this invoice, please contact support."
}
```

---

## ğŸ”§ Manual Database Seeding (If Needed)

If you need to re-seed the database later:

```bash
npx convex run setup/seedDatabase:seedDatabase
```

This command:
- Creates company settings if missing
- Generates all email template variables
- Adds default email templates
- **Safe to run multiple times** (skips existing data)

---

## ğŸ”‘ Getting API Keys

### Convex (Database)
1. Automatically set up when you run `npm run setup`
2. Values added to `.env.local` automatically

### Clerk (Authentication)
1. Go to [Clerk Dashboard](https://dashboard.clerk.com)
2. Create new application
3. Copy **Publishable Key** and **Secret Key**
4. Paste into `.env.local`

### Stripe (Payments)
1. Go to [Stripe Dashboard](https://dashboard.stripe.com)
2. Switch to **Test mode**
3. Go to **Developers** â†’ **API keys**
4. Copy **Publishable key** and **Secret key**
5. Paste into `.env.local`

---

## ğŸ¯ Post-Setup Configuration

### 1. Update Company Settings

After first login as super admin:

1. Go to `/admin/email-management`
2. Click **Settings** tab
3. Update:
   - Company name
   - Email from name
   - Email from address
   - Resend API key (for sending emails)

### 2. Generate Email Variables

1. Go to **Variables** tab
2. Click **Auto Generate Variables**
3. Update variable values with your actual URLs
4. Click **Save Changes**

### 3. Customize Email Templates

1. Go to **Templates** tab
2. Edit default templates or create new ones
3. Use variables like `{company_name}`, `{user_name}`, etc.

---

## ğŸš€ Running the Application

### Development Mode

```bash
# Terminal 1: Convex database
npx convex dev

# Terminal 2: Next.js app
npm run dev
```

**Access Points:**
- Frontend: `http://localhost:3000`
- Admin Panel: `http://localhost:3000/admin`
- Convex Dashboard: `https://dashboard.convex.dev`

### Production Build

```bash
npm run build
npm start
```

---

## ğŸ” Troubleshooting

### Setup Command Fails

```bash
# Clear and retry
rm -rf node_modules package-lock.json
npm install
npm run setup
```

### Convex Not Starting

```bash
# Clear Convex cache
rm -rf .convex
npx convex dev
```

### Database Tables Not Created

```bash
# Manually run Convex deployment
npx convex dev --once
```

### Seed Data Not Created

```bash
# Manually run seed
npx convex run setup/seedDatabase:seedDatabase
```

### Admin Access Denied

1. Verify `role: "super_admin"` in Clerk public metadata
2. Log out and log back in
3. Clear browser cache

---

## ğŸ“š Key Features

âœ… **One-Command Setup** - `npm run setup` does everything  
âœ… **Auto Database Creation** - All 30 tables created automatically  
âœ… **Default Data Seeded** - Company settings, variables, templates, invoice config  
âœ… **Multi-Tenant SaaS** - Organization-based isolation  
âœ… **Stripe Integration** - Subscriptions + payments  
âœ… **Email Management** - Templates, campaigns, variables  
âœ… **Admin Panel** - User management, analytics, activity logs  
âœ… **Credit System** - Purchase and track credits  
âœ… **Support Tickets** - Built-in ticketing with messages  
âœ… **Referral System** - Track referrals and codes  
âœ… **Security Controls** - IP and country blacklists  

---

## ğŸ¯ What to Do After Setup

1. âœ… Update company settings in admin panel
2. âœ… Configure email templates and variables
3. âœ… Set up Stripe products and prices
4. âœ… Test user registration flow
5. âœ… Test subscription checkout
6. âœ… Customize branding and colors
7. âœ… Deploy to production

---

## ğŸ“– Additional Documentation

- `docs/VARIABLE.md` - Email variable system guide
- `docs/PAYMENT.md` - Stripe integration details
- `docs/INVOICE.md` - Invoice management
- `docs/SETTINGS_CONFIG.md` - Configuration options

---

## ğŸ’¡ Quick Reference

### Essential Commands

```bash
# Initial setup (run once)
npm run setup

# Start development
npm run dev

# Re-seed database
npx convex run setup/seedDatabase:seedDatabase

# Deploy Convex to production
npx convex deploy

# Build for production
npm run build
```

### Important URLs

- Convex Dashboard: https://dashboard.convex.dev
- Clerk Dashboard: https://dashboard.clerk.com
- Stripe Dashboard: https://dashboard.stripe.com

---

**Built with â¤ï¸ for developers**

Need help? Check the `docs/` folder or create an issue on GitHub.